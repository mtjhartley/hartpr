{% extends 'base.j2' %}

	{% block content %}
		<div class ="container">
		<div class="col-lg-12">
		<canvas id="myChart" width="1110" height="200"></canvas>
		<h2 align="center">Washington Melee Leaderboard</h2>
		<h3 id="last_update" align="center">Last update: {{last_update[5:]+last_update[4]+last_update[:4]}}</h3>

			<table class="table table-striped" id=ranking_index_table>
			<tr class="table_header">
				<th class="center_td">Rank</th>
				<th style="padding-left:4%">Tag</th>
				<th class="center_td">Trueskill</th>
				<th class="center_td">Win/Loss</th>
				<th class="center_td">Winrate</th>
			</tr>
			{% for player in players %}
				
				<tr>
					<td class="center_td">{{player["rank"]}}</td>
					<td>

					{% if player['color']%}
						<img src="/static/stock_icons/{{player['character']}}/{{player['character']}}-{{player['color']}}.png" style="margin-right: 8px" style="margin-bottom:10px">
					{% else %}
						<img src="/static/stock_icons/{{player['character']}}/{{player['character']}}.png" style="margin-right: 8px" style="margin-top:10px">
					{% endif %}

					<a href="{{url_for('player', player_id=player['id'])}}">{{player["display_name"]}}</a>
					</td>

					<td class="center_td">{{player["trueskill_thousand_test"]}}</td>
					<td class="center_td">
					<div class = "progress">
						<div class = "progress-bar progress-bar-success" id="progress_success" style ="width: {{ player["set_win_percent"] }}%">
						{{ player["set_win_count"]}}
						</div> 
						<div class = "progress-bar progress-bar-danger" id="progress_failure" style = "width: {{ 100 - player["set_win_percent"] }}%">
						{{player["set_lose_count"] }}
						</div>
					</div>
					</td>
					<td class="center_td">{{player["set_win_percent"]}}%</td>
				</tr>
			{% endfor %}
			</table>
		</div>
		</div>

		<script>
			var ctx = document.getElementById("myChart");
			var myChart = new Chart(ctx, {
			    type: 'bar',
			    data: {
			        labels: [
			        {% for skillTier in skillDistribution %}
			        	"",
			        {% endfor %}
			        ],
			        datasets: [{
			        	range: [
			            {% for skillTier in skillDistribution %}
			            	"{{ skillTier["range"] }}",
			            {% endfor %}
			        	],
			            data: [
			            {% for skillTier in skillDistribution %}
			            	{{ skillTier["numPeople"] }},
			            {% endfor %}
			            ],
			            backgroundColor: [
			            {% for skillTier in skillDistribution %}
			            	'{{ skillTier["backgroundColor"] }}',
			            {% endfor %}
			            ],
			            borderColor: [
			            {% for skillTier in skillDistribution %}
			            	'{{ skillTier["borderColor"] }}',
			            {% endfor %}
			            ],
			            borderWidth: 1
			        }]
			    },
			    options: {
			    	legend: {
			    		display: false,
			    	},
			    	title: {
			    		fullWidth: false,
			    		display: true,
			    		text: "Skill Rating Distrubtion: Washington Melee",
			    		position: 'top',
			    		fontSize: 16,
			    		fontColor: "black"
			    	},
			        scales: {
			            yAxes: [{
			                scaleLabel: {
			            		display: true,
			            		labelString: "# People In Skill Bracket",
			            		fontSize: 13,
			            		fontColor: "black"
			            	},
			           		ticks: {
			                    beginAtZero: true,
                             	fixedStepSize: 15,
			                },
			            }]
			        },
			        tooltips: {
			        	callbacks: {
			        		title: function(items, data) {
			        			return `Skill Rating: ${data.datasets[0].range[items[0].index]}`.replace("$", "âžŸ")
			        		},
			        		label: function (items, data) {
			        			return `Count: ${data.datasets[0].data[items.index]}`
			        		}
			        	}
			        }
			    }
			});
		</script>
		<div class="center">
		  <div class="pagination">
		    <!-- <a href="#">&laquo;</a> -->

		    <a {%- if request.path == url_for('index', page=1) %} class="active" {% endif %} href="{{url_for('index', page=1)}}">1</a>
		    <a {%- if request.path == url_for('index', page=2) %} class="active" {% endif %} href="{{url_for('index', page=2)}}">2</a>
		    <a {%- if request.path == url_for('index', page=3) %} class="active" {% endif %} href="{{url_for('index', page=3)}}">3</a>
		    <a {%- if request.path == url_for('index', page=4) %} class="active" {% endif %} href="{{url_for('index', page=4)}}">4</a>
		    <a {%- if request.path == url_for('index', page=5) %} class="active" {% endif %} href="{{url_for('index', page=5)}}">5</a>
		    <a {%- if request.path == url_for('index', page=6) %} class="active" {% endif %} href="{{url_for('index', page=6)}}">6</a>
		    <a {%- if request.path == url_for('index', page=7) %} class="active" {% endif %} href="{{url_for('index', page=7)}}">7</a>
		    <a {%- if request.path == url_for('index', page=8) %} class="active" {% endif %} href="{{url_for('index', page=8)}}">8</a>
		    <a {%- if request.path == url_for('index', page=9) %} class="active" {% endif %} href="{{url_for('index', page=9)}}">9</a>
		    <a {%- if request.path == url_for('index', page=10) %} class="active" {% endif %} href="{{url_for('index', page=10)}}">10</a>
		    <a {%- if request.path == url_for('index', page=11) %} class="active" {% endif %} href="{{url_for('index', page=11)}}">11</a>
		    <a {%- if request.path == url_for('index', page=12) %} class="active" {% endif %} href="{{url_for('index', page=12)}}">12</a>
		    <a {%- if request.path == url_for('index', page=13) %} class="active" {% endif %} href="{{url_for('index', page=13)}}">13</a>
		    <a {%- if request.path == url_for('index', page=14) %} class="active" {% endif %} href="{{url_for('index', page=14)}}">14</a>
		    <a {%- if request.path == url_for('index', page=15) %} class="active" {% endif %} href="{{url_for('index', page=15)}}">15</a>
		    <a {%- if request.path == url_for('index', page=16) %} class="active" {% endif %} href="{{url_for('index', page=16)}}">16</a>
		    <a {%- if request.path == url_for('index', page=17) %} class="active" {% endif %} href="{{url_for('index', page=17)}}">17</a>
		    <!-- <a href="#">&raquo;</a> -->
		  </div>
		</div>
	{% endblock %}
